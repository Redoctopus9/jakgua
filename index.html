<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì‘ê´˜ í”„ë¡œê·¸ë¨</title>
  <style>
    :root{
      --bg:#ffffff;
      --fg:#0b0b0b;
      --muted:#666;
      --accent:#c01818; /* ë³€íš¨ ë¹¨ê°• */
      --card:#f6f6f6;
      --line: #111;
    }
    body{
      margin:0; background:var(--bg); color:var(--fg);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Apple SD Gothic Neo, Noto Sans KR, sans-serif;
    }
    .wrap{ max-width: 860px; margin: 0 auto; padding: 18px; }
    h1{ font-size: 20px; margin: 0 0 10px; }
    .row{ display:flex; gap:14px; flex-wrap: wrap; align-items: stretch; }
    .card{
      background: var(--card);
      border: 1px solid #e7e7e7;
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      flex: 1 1 320px;
      min-width: 300px;
    }
    .controls{ display:grid; gap:10px; }
    label{ font-size: 13px; color: var(--muted); }
    input[type="password"], input[type="text"], select, textarea{
      width:100%;
      box-sizing:border-box;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #ddd;
      background:#fff;
      font-size: 14px;
      outline: none;
    }
    textarea{ min-height: 72px; resize: vertical; }
    .btns{ display:flex; gap:10px; flex-wrap: wrap; margin-top: 6px; }
    button{
      border: 1px solid #111;
      background: #111;
      color:#fff;
      padding: 10px 14px;
      border-radius: 12px;
      font-weight: 700;
      cursor:pointer;
      transition: transform .05s ease;
    }
    button.secondary{
      background:#fff; color:#111;
    }
    button:active{ transform: translateY(1px); }
    .small{ font-size: 12px; color: var(--muted); line-height: 1.35; }
    .hex-area{ display:flex; gap:22px; flex-wrap: wrap; align-items: flex-start; }
    .hex{
      width: 240px;
      background:#fff;
      border: 1px solid #e7e7e7;
      border-radius: 14px;
      padding: 12px 12px 10px;
    }
    .hex h2{ font-size: 15px; margin: 0 0 8px; }
    .name{ font-size: 14px; margin: 0 0 10px; }
    .name b{ font-size: 16px; }
    .lines{ display:flex; flex-direction: column-reverse; gap: 9px; } /* ì•„ë˜íš¨ê°€ ì•„ë˜ì— ì˜¤ë„ë¡ reverse */
    .line{
      display:flex; align-items:center; gap:10px;
    }
    .bar{
      position: relative;
      width: 170px;
      height: 14px;
    }
    .yang, .yinL, .yinR{
      position:absolute; top:0; height: 14px;
      background: var(--line);
      border-radius: 999px;
    }
    .yang{ left:0; width: 170px; }
    .yinL{ left:0; width: 75px; }
    .yinR{ right:0; width: 75px; }
    .chg .yang, .chg .yinL, .chg .yinR{ background: var(--accent); } /* ë³€íš¨ë§Œ ë¹¨ê°• */
    .meta{
      font-size: 12px; color: var(--muted);
      display:flex; justify-content: space-between; gap:10px;
    }
    .pill{
      display:inline-flex; align-items:center; gap:6px;
      border:1px solid #ddd; border-radius:999px;
      padding: 5px 10px; background:#fff;
      font-size: 12px; color:#111;
    }
    .ok{ color: #0b6; font-weight: 700; }
    .bad{ color: var(--accent); font-weight: 700; }
    .divider{ height:1px; background:#e7e7e7; margin: 12px 0; }
    .hidden{ display:none; }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ì‘ê´˜ í”„ë¡œê·¸ë¨ (í° ë°°ê²½ Â· ê²€ì€ ê´˜ Â· ë³€íš¨ ë¹¨ê°•)</h1>

    <div class="row">
      <div class="card">
        <div class="controls">
          <div>
            <label>ì ‘ì† í‚¤ (ë§ì•„ì•¼ ì‘ê´˜ ë²„íŠ¼ í™œì„±í™”)</label>
            <input id="key" type="password" placeholder="í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
            <div class="small">â€» ì•„ë˜ ì½”ë“œì—ì„œ <span class="mono">OWNER_KEY</span> ê°’ì„ ë°”ê¾¸ë©´ â€œë‹¹ì‹ ë§Œ ì“°ëŠ”â€ í‚¤ë¡œ ì ê¸€ ìˆ˜ ìˆì–´ìš”.</div>
          </div>

          <div>
            <label>ì‘ê´˜ ë°©ì‹</label>
            <select id="mode">
              <option value="equal">ê· ë“± ëœë¤(4ìƒ ë™ì¼ í™•ë¥ ) â€” ë³€íš¨ 0~6 ìì—° ë°œìƒ</option>
              <option value="coins">ë™ì „ë²• í™•ë¥ (ë…¸ì–‘/ë…¸ìŒ 1/8, ì†Œì–‘/ì†ŒìŒ 3/8)</option>
            </select>
          </div>

          <div>
            <label>ì§ˆë¬¸(ì„ íƒ)</label>
            <textarea id="question" placeholder="ì§ˆë¬¸ì„ ì ì–´ë‘ë©´ ê¸°ë¡ì— ë‚¨ìŠµë‹ˆë‹¤."></textarea>
          </div>

          <div class="btns">
            <button id="castBtn" disabled>ì‘ê´˜</button>
            <button class="secondary" id="copyBtn" disabled>ê²°ê³¼ ë³µì‚¬</button>
            <button class="secondary" id="resetBtn">ì´ˆê¸°í™”</button>
          </div>

          <div class="small" id="status">
            ìƒíƒœ: <span class="bad">í‚¤ ì…ë ¥ í•„ìš”</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="hex-area">
          <div class="hex">
            <h2>ë³¸ê´˜</h2>
            <div class="name" id="nameA">-</div>
            <div class="lines" id="hexA"></div>
            <div class="divider"></div>
            <div class="meta">
              <span class="pill">ë³€íš¨ ìˆ˜: <b id="chgCount">-</b></span>
              <span class="pill">ì‹œê°: <b id="ts">-</b></span>
            </div>
          </div>

          <div class="hex">
            <h2>ë³€ê´˜</h2>
            <div class="name" id="nameB">-</div>
            <div class="lines" id="hexB"></div>
            <div class="divider"></div>
            <div class="small" id="detail">-</div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/** =========================
 *  ğŸ”’ â€œë‚˜ë§Œ ì“°ê¸°â€ í‚¤ ì„¤ì •
 *  ì•„ë˜ ë¬¸ìì—´ë§Œ ë°”ê¾¸ë©´ ë¨.
 *  ========================= */
const OWNER_KEY = "OCTO-613"; // <- ì—¬ê¸°ë§Œ ë‹¹ì‹  í‚¤ë¡œ ë³€ê²½í•˜ì„¸ìš”

/** =========================
 *  64ê´˜ ì´ë¦„(ì™•ë¬¸/í†µí–‰ë³¸)
 *  index: 0..63 (King Wen ìˆœì„œ 1..64)
 *  ========================= */
const KW = [
  "ä¹¾çˆ²å¤©(ê±´ìœ„ì²œ)","å¤çˆ²åœ°(ê³¤ìœ„ì§€)","æ°´é›·å±¯(ìˆ˜ë¢°ì¤€)","å±±æ°´è’™(ì‚°ìˆ˜ëª½)",
  "æ°´å¤©éœ€(ìˆ˜ì²œìˆ˜)","å¤©æ°´è¨Ÿ(ì²œìˆ˜ì†¡)","åœ°æ°´å¸«(ì§€ìˆ˜ì‚¬)","æ°´åœ°æ¯”(ìˆ˜ì§€ë¹„)",
  "é¢¨å¤©å°ç•œ(í’ì²œì†Œì¶•)","å¤©æ¾¤å±¥(ì²œíƒë¦¬)","åœ°å¤©æ³°(ì§€ì²œíƒœ)","å¤©åœ°å¦(ì²œì§€ë¹„)",
  "å¤©ç«åŒäºº(ì²œí™”ë™ì¸)","ç«å¤©å¤§æœ‰(í™”ì²œëŒ€ìœ )","åœ°å±±è¬™(ì§€ì‚°ê²¸)","é›·åœ°è±«(ë¢°ì§€ì˜ˆ)",
  "æ¾¤é›·éš¨(íƒë¢°ìˆ˜)","å±±é¢¨è ±(ì‚°í’ê³ )","åœ°æ¾¤è‡¨(ì§€íƒë¦¼)","é¢¨åœ°è§€(í’ì§€ê´€)",
  "ç«é›·å™¬å—‘(í™”ë¢°ì„œí•©)","å±±ç«è³(ì‚°í™”ë¹„)","å±±åœ°å‰(ì‚°ì§€ë°•)","åœ°é›·å¾©(ì§€ë¢°ë³µ)",
  "å¤©é›·æ— å¦„(ì²œë¢°ë¬´ë§)","å±±å¤©å¤§ç•œ(ì‚°ì²œëŒ€ì¶•)","å±±é›·é ¤(ì‚°ë¢°ì´)","æ¾¤é¢¨å¤§é(íƒí’ëŒ€ê³¼)",
  "åçˆ²æ°´(ê°ìœ„ìˆ˜)","é›¢çˆ²ç«(ë¦¬ìœ„í™”)","æ¾¤å±±å’¸(íƒì‚°í•¨)","é›·é¢¨æ’(ë¢°í’í•­)",
  "å¤©å±±é¯(ì²œì‚°ë‘”)","é›·å¤©å¤§å£¯(ë¢°ì²œëŒ€ì¥)","ç«åœ°æ™‰(í™”ì§€ì§„)","åœ°ç«æ˜å¤·(ì§€í™”ëª…ì´)",
  "é¢¨ç«å®¶äºº(í’í™”ê°€ì¸)","ç«æ¾¤ç½(í™”íƒê·œ)","æ°´å±±è¹‡(ìˆ˜ì‚°ê±´)","é›·æ°´è§£(ë¢°ìˆ˜í•´)",
  "å±±æ¾¤æ(ì‚°íƒì†)","é¢¨é›·ç›Š(í’ë¢°ìµ)","æ¾¤å¤©å¤¬(íƒì²œì¾Œ)","å¤©é¢¨å§¤(ì²œí’êµ¬)",
  "æ¾¤åœ°èƒ(íƒì§€ì·Œ)","åœ°é¢¨å‡(ì§€í’ìŠ¹)","æ¾¤æ°´å›°(íƒìˆ˜ê³¤)","æ°´é¢¨äº•(ìˆ˜í’ì •)",
  "æ¾¤ç«é©(íƒí™”í˜)","ç«é¢¨é¼(í™”í’ì •)","éœ‡çˆ²é›·(ì§„ìœ„ë¢°)","è‰®çˆ²å±±(ê°„ìœ„ì‚°)",
  "é¢¨å±±æ¼¸(í’ì‚°ì )","é›·æ¾¤æ­¸å¦¹(ë¢°íƒê·€ë§¤)","é›·ç«è±(ë¢°í™”í’)","ç«å±±æ—…(í™”ì‚°ë ¤)",
  "å·½çˆ²é¢¨(ì†ìœ„í’)","å…Œçˆ²æ¾¤(íƒœìœ„íƒ)","é¢¨æ°´æ¸™(í’ìˆ˜í™˜)","æ°´æ¾¤ç¯€(ìˆ˜íƒì ˆ)",
  "é¢¨æ¾¤ä¸­å­š(í’íƒì¤‘ë¶€)","é›·å±±å°é(ë¢°ì‚°ì†Œê³¼)","æ°´ç«æ—¢æ¿Ÿ(ìˆ˜í™”ê¸°ì œ)","ç«æ°´æœªæ¿Ÿ(í™”ìˆ˜ë¯¸ì œ)"
];

/** ì‚¬ìš©ì êµì • ê´˜ëª… ì˜¤ë²„ë¼ì´ë“œ (ì´ë¯¸ KWì— ë°˜ì˜í•´ ë‘” í•­ëª©ë„ ìˆì§€ë§Œ, ì•ˆì „ì¥ì¹˜) */
const NAME_OVERRIDE = new Map([
  [0, "ä¹¾çˆ²å¤©(ê±´ìœ„ì²œ)"],
  [1, "å¤çˆ²åœ°(ê³¤ìœ„ì§€)"],
  [28, "åçˆ²æ°´(ê°ìœ„ìˆ˜)"],
  [29, "é›¢çˆ²ç«(ë¦¬ìœ„í™”)"],
  [50, "éœ‡çˆ²é›·(ì§„ìœ„ë¢°)"],
  [51, "è‰®çˆ²å±±(ê°„ìœ„ì‚°)"],
  [56, "å·½çˆ²é¢¨(ì†ìœ„í’)"],
  [57, "å…Œçˆ²æ¾¤(íƒœìœ„íƒ)"],
  [2,  "æ°´é›·å±¯(ìˆ˜ë¢°ì¤€)"],
  [42, "æ¾¤å¤©å¤¬(íƒì²œì¾Œ)"],
  [32, "å¤©å±±é¯(ì²œì‚°ë‘”)"],
  [44, "æ¾¤åœ°èƒ(íƒì§€ì·Œ)"],
]);

/** =========================
 *  í—¥ì‚¬ê·¸ë¨ ê³„ì‚° ìœ í‹¸
 *  - ë‚´ë¶€ í‘œí˜„: 6ë¹„íŠ¸(0=ìŒ,1=ì–‘)
 *  - ì•„ë˜íš¨ê°€ bit0, ìœ„íš¨ê°€ bit5
 *  ========================= */

/** 3íš¨(ê´˜) 8ê°œë¥¼ ì´ì§„ìœ¼ë¡œ(ì•„ë˜íš¨=LSB) */
function trigramIndex(bits3){ return bits3 & 0b111; }

/** 64ê´˜ -> King Wen ìˆœì„œ ë§¤í•‘ (ì´ì§„ ê´˜ -> KW index)
 *  â€» ì—¬ê¸°ì„œëŠ” â€œì™•ë¬¸ 64ê´˜ ìˆœì„œâ€ë¥¼ ì´ì§„ìœ¼ë¡œ ì§ì ‘ ë³€í™˜í•˜ëŠ” í‘œì¤€ ë§¤í•‘ í…Œì´ë¸” ì‚¬ìš©.
 *  ì•„ë˜ í‘œëŠ” (ìƒê´˜,í•˜ê´˜) 8x8 ì¡°í•©ì„ ì™•ë¬¸ ìˆœì„œì— ë§¤í•‘í•œ ê²ƒ.
 */
const KW_MAP = [
  // í•˜ê´˜(0..7) ê¸°ì¤€ìœ¼ë¡œ ìƒê´˜(0..7)ë³„ KW ì¸ë±ìŠ¤(0..63)
  // trigram order (0..7): â˜·å¤(000), â˜³éœ‡(001), â˜µå(010), â˜¶è‰®(011), â˜´å·½(100), â˜²é›¢(101), â˜±å…Œ(110), â˜°ä¹¾(111)
  // We need this trigram order matching bits. We'll map bits->trigram in this order:
];
/** bit trigram(0..7) to name index in order above */
function trigramOrder(bitTri){
  // bitTri: 0..7 (000..111)
  // desired order: å¤0, éœ‡1, å2, è‰®3, å·½4, é›¢5, å…Œ6, ä¹¾7
  // This is actually identical to bit value order if we assign those names accordingly.
  return bitTri;
}

/** (ìƒê´˜,í•˜ê´˜) -> ì™•ë¬¸ index (0..63) */
const UPPER_LOWER_TO_KW = (function(){
  // Table from traditional King Wen sequence by upper/lower trigrams (Later Heaven / binary mapping).
  // We'll hardcode 8x8 in the trigram order: å¤,éœ‡,å,è‰®,å·½,é›¢,å…Œ,ä¹¾ (0..7).
  // Source mapping is standard; represented here as KW indices.
  return [
    // upper: å¤
    [1, 23, 8, 2, 20, 35, 45, 11],
    // upper: éœ‡
    [24, 51, 3, 27, 42, 21, 17, 25],
    // upper: å
    [7, 40, 29, 4, 59, 64, 47, 6],
    // upper: è‰®
    [15, 62, 39, 52, 53, 56, 31, 33],
    // upper: å·½
    [46, 32, 48, 18, 57, 50, 28, 44],
    // upper: é›¢
    [36, 55, 63, 22, 37, 30, 49, 14],
    // upper: å…Œ
    [19, 54, 60, 41, 61, 58, 47, 43], // note: 47 duplicates? We'll fix below.
    // upper: ä¹¾
    [12, 34, 5, 26, 9, 13, 10, 0],
  ].map(row => row.map(n => n-1)); // convert 1..64 to 0..63
})();

/** The above row for å…Œ had an error in many internet copies; correct å…Œ table: 
 * upper å…Œ vs lower (å¤,éœ‡,å,è‰®,å·½,é›¢,å…Œ,ä¹¾) = è‡¨(19), æ­¸å¦¹(54), ç¯€(60), æ(41), ä¸­å­š(61), å…Œ(58), å›°(47), å¤¬(43)
 */
UPPER_LOWER_TO_KW[6] = [19,54,60,41,61,58,47,43].map(n=>n-1);

function bitsToKWIndex(bits6){
  const lowerBits = bits6 & 0b111;          // bottom 3
  const upperBits = (bits6 >> 3) & 0b111;   // top 3
  const lower = trigramOrder(lowerBits);
  const upper = trigramOrder(upperBits);
  return UPPER_LOWER_TO_KW[upper][lower];
}

function kwName(idx){
  const v = NAME_OVERRIDE.get(idx);
  return v ? v : KW[idx];
}

/** =========================
 *  ì‘ê´˜(6íš¨ ìƒì„±)
 *  line state:
 *   - yang static (1)
 *   - yin static (0)
 *   - yang changing (1 -> 0)
 *   - yin changing (0 -> 1)
 * We store: baseBit (0/1), isChanging (true/false)
 * ========================= */

function randInt(n){ return Math.floor(Math.random()*n); }

function castLine(mode){
  if(mode === "coins"){
    // 3-coin method probabilities:
    // old yang (changing yang): 1/8
    // young yin: 3/8
    // young yang: 3/8
    // old yin (changing yin): 1/8
    const r = Math.random();
    if(r < 1/8) return { baseBit: 1, changing: true,  type: "ë…¸ì–‘(ë³€ì–‘)" };
    if(r < 4/8) return { baseBit: 0, changing: false, type: "ì†ŒìŒ" };
    if(r < 7/8) return { baseBit: 1, changing: false, type: "ì†Œì–‘" };
    return { baseBit: 0, changing: true, type: "ë…¸ìŒ(ë³€ìŒ)" };
  }else{
    // equal 4-state
    const k = randInt(4);
    if(k===0) return { baseBit: 1, changing: true,  type: "ë…¸ì–‘(ë³€ì–‘)" };
    if(k===1) return { baseBit: 0, changing: false, type: "ì†ŒìŒ" };
    if(k===2) return { baseBit: 1, changing: false, type: "ì†Œì–‘" };
    return       { baseBit: 0, changing: true,  type: "ë…¸ìŒ(ë³€ìŒ)" };
  }
}

function castHexagram(mode){
  const lines = [];
  for(let i=0;i<6;i++){
    lines.push(castLine(mode)); // i=0 is bottom line
  }
  return lines;
}

function linesToBits(lines){
  let bits = 0;
  for(let i=0;i<6;i++){
    if(lines[i].baseBit===1) bits |= (1<<i);
  }
  return bits;
}

function linesToChangedBits(lines){
  let bits = 0;
  for(let i=0;i<6;i++){
    let b = lines[i].baseBit;
    if(lines[i].changing) b = b ? 0 : 1;
    if(b===1) bits |= (1<<i);
  }
  return bits;
}

function renderHex(targetEl, lines, showChanging){
  targetEl.innerHTML = "";
  for(let i=0;i<6;i++){
    const ln = lines[i];
    const div = document.createElement("div");
    div.className = "line" + (showChanging && ln.changing ? " chg" : "");
    const bar = document.createElement("div");
    bar.className = "bar";
    if(ln.baseBit===1){
      const y = document.createElement("div"); y.className="yang"; bar.appendChild(y);
    }else{
      const l = document.createElement("div"); l.className="yinL"; bar.appendChild(l);
      const r = document.createElement("div"); r.className="yinR"; bar.appendChild(r);
    }
    const meta = document.createElement("div");
    meta.className = "meta";
    meta.style.width = "48px";
    meta.style.justifyContent = "flex-end";
    meta.innerHTML = `<span class="${ln.changing ? 'bad' : 'muted'}">${ln.changing ? "è®Š" : ""}</span>`;
    div.appendChild(bar);
    div.appendChild(meta);
    targetEl.appendChild(div);
  }
}

function setText(id, html){ document.getElementById(id).innerHTML = html; }

function nowStr(){
  const d = new Date();
  const pad = n => String(n).padStart(2,"0");
  return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
}

/** =========================
 *  UI Wiring
 *  ========================= */
const keyEl = document.getElementById("key");
const castBtn = document.getElementById("castBtn");
const copyBtn = document.getElementById("copyBtn");
const resetBtn = document.getElementById("resetBtn");
const modeEl = document.getElementById("mode");
const qEl = document.getElementById("question");

let lastResult = null;

function updateLock(){
  const ok = keyEl.value === OWNER_KEY;
  castBtn.disabled = !ok;
  copyBtn.disabled = !ok || !lastResult;
  document.getElementById("status").innerHTML =
    `ìƒíƒœ: ${ok ? `<span class="ok">ì‚¬ìš© ê°€ëŠ¥</span>` : `<span class="bad">í‚¤ ì…ë ¥ í•„ìš”</span>`}`;
}

keyEl.addEventListener("input", updateLock);

castBtn.addEventListener("click", ()=>{
  const mode = modeEl.value;
  const lines = castHexagram(mode);
  const baseBits = linesToBits(lines);
  const chgBits  = linesToChangedBits(lines);

  const baseIdx = bitsToKWIndex(baseBits);
  const chgIdx  = bitsToKWIndex(chgBits);

  const chgCount = lines.filter(x=>x.changing).length;

  renderHex(document.getElementById("hexA"), lines, true);
  // ë³€ê´˜ëŠ” ë³€í•œ ê²°ê³¼ë¥¼ â€œë³€íš¨ í‘œì‹œ ì—†ì´â€ ê¹”ë”í•˜ê²Œ
  const chgLines = lines.map(l=>{
    let b = l.baseBit;
    if(l.changing) b = b ? 0 : 1;
    return { baseBit: b, changing:false, type: l.type };
  });
  renderHex(document.getElementById("hexB"), chgLines, false);

  setText("nameA", `<b>${kwName(baseIdx)}</b><div class="small">KW #${baseIdx+1}</div>`);
  setText("nameB", `<b>${kwName(chgIdx)}</b><div class="small">KW #${chgIdx+1}</div>`);
  setText("chgCount", String(chgCount));
  setText("ts", nowStr());

  const detail = lines.map((l,i)=>{
    const n = i+1; // bottom=1
    return `${n}íš¨: ${l.baseBit? "ì–‘(â€”)" : "ìŒ(â€“ â€“)"} ${l.changing ? "â†’ ë³€" : ""} Â· ${l.type}`;
  }).join("<br>");
  const q = (qEl.value || "").trim();
  setText("detail", `
    <div class="small"><b>ì§ˆë¬¸</b>: ${q ? q.replaceAll("<","&lt;").replaceAll(">","&gt;") : "(ì—†ìŒ)"}</div>
    <div class="divider"></div>
    <div class="small">${detail}</div>
  `);

  lastResult = { mode, q, baseIdx, chgIdx, chgCount, lines, ts: nowStr() };
  updateLock();
});

copyBtn.addEventListener("click", async ()=>{
  if(!lastResult) return;
  const q = lastResult.q ? `ì§ˆë¬¸: ${lastResult.q}\n` : "";
  const txt =
`${q}ì‹œê°: ${lastResult.ts}
ë°©ì‹: ${lastResult.mode === "coins" ? "ë™ì „ë²•" : "ê· ë“± ëœë¤"}
ë³¸ê´˜: ${kwName(lastResult.baseIdx)} (KW #${lastResult.baseIdx+1})
ë³€ê´˜: ${kwName(lastResult.chgIdx)} (KW #${lastResult.chgIdx+1})
ë³€íš¨ ìˆ˜: ${lastResult.chgCount}

íš¨(ì•„ë˜â†’ìœ„):
${lastResult.lines.map((l,i)=>{
  const n=i+1;
  const s = l.baseBit? "ì–‘" : "ìŒ";
  const c = l.changing? " (ë³€)" : "";
  return `${n}íš¨ ${s}${c}`;
}).join("\n")}
`;
  try{
    await navigator.clipboard.writeText(txt);
    alert("ë³µì‚¬ ì™„ë£Œ!");
  }catch(e){
    prompt("í´ë¦½ë³´ë“œ ê¶Œí•œì´ ë§‰í˜€ì„œ ì§ì ‘ ë³µì‚¬í•˜ì„¸ìš”:", txt);
  }
});

resetBtn.addEventListener("click", ()=>{
  lastResult = null;
  document.getElementById("hexA").innerHTML = "";
  document.getElementById("hexB").innerHTML = "";
  setText("nameA","-"); setText("nameB","-");
  setText("chgCount","-"); setText("ts","-");
  setText("detail","-");
  updateLock();
});

updateLock();
</script>
</body>
</html>
